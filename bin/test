SCHEMES=(
    Reconcilation
    Nift
    AppKitX
)

function test {
    local SCHEME=$1
    local DERIVED_DATA_PATH=$(mktemp -d)
    trap "rm -r $DERIVED_DATA_PATH" EXIT

    xcodebuild \
        -derivedDataPath $DERIVED_DATA_PATH \
        -workspace Nift.xcworkspace \
        -scheme $SCHEME \
        test

    exit
}

for SCHEME in "${SCHEMES[@]}"; do
    test $SCHEME &
done

wait
